<div class="layui-form" lay-filter="zkmes-dialog-rotselect-form" style="padding: 10px 30px 0 0">
  <!-    传值给父start ->
  <div class="layui-form-item layui-hide">
    <div class="layui-inline">
      <label class="layui-form-label">税率编码</label>
      <div class="layui-input-inline">
        <input type="text" name="rotId" placeholder="请输入" autocomplete="off" class="layui-input" />
      </div>
    </div>
  
    <div class="layui-inline">
      <label class="layui-form-label">税率</label>
      <div class="layui-input-inline">
        <input type="text" name="rot" placeholder="请输入" autocomplete="off" class="layui-input" />
      </div>
    </div>
  </div>
  <!-    传值给父end ->

  <div class="layui-form-item">
    <table
      id="zkmes-dialog-rotselect-form-table"
      lay-filter="zkmes-dialog-rotselect-form-table"
    ></table>
    <script type="text/html" id="zkmes-dialog-rotselect-form-toolbar-row"></script>
  </div>

  <div class="layui-form-item layui-hide">
    <label class="layui-form-label"></label>
    <div class="layui-input-inline">
      <input
        type="button"
        id="zkmes-dialog-rotselect-form-submit"
        lay-submit
        lay-filter="zkmes-dialog-rotselect-form-submit"
        value="确认"
        class="layui-btn"
      />
    </div>
  </div>
</div>

<script>
  layui.use(["admin", "form"], function () {
    var $ = layui.$,
      admin = layui.admin,
      view = layui.view,
      table = layui.table,
      form = layui.form;

    active = {
      reload: function () {
        var rotId = $("#rotId");
        //执行重载
        table.reloadData("zkmes-dialog-rotselect-form-table", {
          page: {
            curr: 1, //重新从第 1 页开始
          },
          where: {
            rotId: rotId.val(),
          },
        });
      },
    };

    $(".zkmes-dialog-rotselect-form-search .layui-btn").on("click", function () {
      var type = $(this).data("type");
      active[type] ? active[type].call(this) : "";
    });

    var prefix = "zkmes/rotmgmt/rot";

    table.render({
      elem: "#zkmes-dialog-rotselect-form-table",
      url: prefix + "/list",
      page: true,
      height: "full-350",
      cols: [
        [
          { field: "rotId", title: "税率编码" },
          { field: "rotName", title: "税率名称" },
          { field: "rot", title: "税率" },
          { field: "remark", title: "备注" },
        ],
      ],
    });

    //触发行双击事件
    table.on("rowDouble(zkmes-dialog-rotselect-form-table)", function (obj) {
      // console.log(obj.tr) //得到当前行元素对象
      // console.log(obj.data) //得到当前行数据

      var submit = $("#zkmes-dialog-rotselect-form-submit");
      var data = form.val("zkmes-dialog-rotselect-form", JSON.parse(JSON.stringify(obj.data)));

      form.render();

      submit.trigger("click");
    });
  });
</script>
