<div class="layui-form" lay-filter="zkmes-dialog-productselect-form" style="padding: 10px 30px 0 0">


    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">物料编码</label>
            <div class="layui-input-inline">
                <input type="text" id="productId" name="productId" placeholder="输入物料编码进行搜索" autocomplete="off" class="layui-input" />
            </div>
        </div>

        <div class="layui-inline">
            <label class="layui-form-label">物料名称</label>
            <div class="layui-input-inline">
                <input type="text" id="productName" placeholder="请输入" autocomplete="off" class="layui-input" />
            </div>
        </div>
                <div class="layui-inline zkmes-dialog-productselect-form-search">
            <div class="layui-input-inline">
                <button class="layui-btn " data-type="reload">搜索</button>
            </div>
        </div>
        <div class="layui-inline layui-hide">
            <label class="layui-form-label">物料规格</label>
            <div class="layui-input-inline">
                <input type="text" id="specId" placeholder="请输入" autocomplete="off" class="layui-input" />
            </div>
        </div>
        <div class="layui-inline layui-hide">
            <label class="layui-form-label">物料型号</label>
            <div class="layui-input-inline">
                <input type="text" id="modelId" placeholder="请输入" autocomplete="off" class="layui-input" />
            </div>
        </div>
    </div>
    <div class="layui-form-item layui-hide">
        <div class="layui-inline">
            <label class="layui-form-label">供应商</label>
            <div class="layui-input-inline">
                <input type="text" id="supplierName" placeholder="请输入" autocomplete="off" class="layui-input" />
            </div>
        </div>

        <div class="layui-inline layui-hide">
            <label class="layui-form-label">产品分类</label>
            <div class="layui-input-inline">
                <input type="text" id="classifyName" placeholder="请输入" autocomplete="off" class="layui-input" />
            </div>
        </div>

<!--         <div class="layui-inline zkmes-dialog-productselect-form-search">
            <div class="layui-input-inline">
                <button class="layui-btn " data-type="reload">搜索</button>
            </div>
        </div> -->
    </div>





    <div class="layui-form-item">
        <fieldset class="layui-elem-field layui-field-title">
            <legend>物料总览</legend>
        </fieldset>
        <table id="zkmes-dialog-productselect-form-table"
            lay-filter="zkmes-dialog-productselect-form-table"></table>
        <script type="text/html" id="zkmes-dialog-productselect-form-toolbar-head">
       </script>
    </div>

    <div class="layui-form-item layui-hide">
        <label class="layui-form-label"></label>
        <div class="layui-input-inline">
            <input type="button" id="zkmes-dialog-productselect-form-submit" lay-submit
                lay-filter="zkmes-dialog-productselect-form-submit" value="确认" class="layui-btn" />
        </div>
    </div>
</div>


<script>

    layui.use(["admin", "form"], function () {
        var $ = layui.$,
            admin = layui.admin,
            view = layui.view,
            table = layui.table,
            form = layui.form;

        active = {
            reload: function () {
                var productId = $('#productId');
                //执行重载
                table.reloadData('zkmes-dialog-productselect-form-table', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    , where: {
                        productId: productId.val()
                    }
                });
            }
        };


        $('.zkmes-dialog-productselect-form-search .layui-btn').on('click', function () {
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });

        var prefix = "zkmes/productmgmt/product";

        table.render({
            elem: "#zkmes-dialog-productselect-form-table",
            url: prefix + "/list",
            toolbar: "#zkmes-dialog-productselect-form-toolbar-head",
            page: true,
            defaultToolbar: [
                "filter",
                "print",
                "exports",
                {
                    title: "提示",
                    layEvent: "LAYTABLE_TIPS",
                    icon: "layui-icon-tips",
                },
            ],
            height: "full-350",
            cols: [
                [
                    { type: 'numbers', title: '序号' }, // 使用layui的numbers类型自动生成序号
                    { field: 'productId', title: '物料编码' }
                    , { field: 'productName', title: '物料名称' }
                    , { field: 'specName', title: '规格' }
                    , { field: 'modelName', title: '型号' }
                    , { field: 'uomName', title: '计量单位' }
                    , { field: 'supplierName', title: '供应商' }
                    , { field: 'classifyName', title: '分类' }
                ],
            ],
        });


        //触发行双击事件
        table.on('rowDouble(zkmes-dialog-productselect-form-table)', function (obj) {
            // console.log(obj.tr) //得到当前行元素对象
            //  console.log(obj.data) //得到当前行数据

            var submit = $("#zkmes-dialog-productselect-form-submit")
            var data = form.val('zkmes-dialog-productselect-form', JSON.parse(JSON.stringify(obj.data)));

            form.render();

            //alert(JSON.stringify(data));

            submit.trigger('click');
        });

    });
</script>