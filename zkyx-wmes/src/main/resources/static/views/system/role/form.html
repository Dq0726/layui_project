<div class="layui-form" lay-filter="system-role-form">
  <script type="text/html" template>

    <div class="layui-form-item">
      <label class="layui-form-label">角色编号</label>
      <div class="layui-input-block">
        <input
          type="text"
          name="roleId"
          placeholder="编号自动生成"
          value="{{ d.params.roleId || '' }}"
          autocomplete="off"
          class="layui-input" 
 					disabled 
        />
      </div>
    </div>

  </script>
  <div class="layui-form-item">
    <label class="layui-form-label">权限字符</label>
    <div class="layui-input-block">
      <script type="text/html" template>
        <input type="text" name="roleKey" value="{{ d.params.roleKey || '' }}"  placeholder="标识"  autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>


  <div class="layui-form-item">
    <label class="layui-form-label">角色顺序</label>
    <div class="layui-input-block">
      <script type="text/html" template>
        <input type="text" name="roleSort" value="{{ d.params.roleSort || '' }}"  placeholder="排序"  autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>

  <div class="layui-form-item">
    <label class="layui-form-label">状态</label>
    <div class="layui-input-block">
      <script type="text/html" template>
		<input type="checkbox" name="status"  lay-filter="system-role-form-status" lay-skin="switch" lay-text="ON|OFF" {{d.params.status == 0 ? 'checked' : '' }} >  
      </script>
    </div>
  </div>


  <div class="layui-form-item">
    <label class="layui-form-label">权限</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
          <input
            type="text"
            lay-affix="search"
            lay-filter="searchPermis"
            lay-verify="required"
            readonly
            placeholder="请选择"
            value="{{d.params.menuIds || '' }}"
            name="menuIds"
						id="menuIds"
            lay-options="{split: true}"
            class="layui-input"
          />
        </script>
    </div>
  </div>


  <div class="layui-form-item">
    <label class="layui-form-label">具体描述</label>
    <div class="layui-input-block">
      <script type="text/html" template>
        <textarea type="text" name="descr" autocomplete="off" class="layui-textarea">{{ d.params.descr || '' }}</textarea>
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label"></label>
    <div class="layui-input-inline">

      <input type="button" id="system-role-form-submit" lay-submit lay-filter="system-role-form-submit" value="确认"
        class="layui-btn">
    </div>
  </div>
</div>

<script type="text/html" template lay-done="systemRoleFormParamsDone(d.params)"> 
</script>
 
<script> 
  systemRoleFormParamsDone = function (params) { 
    layui.use(['admin', 'form', 'treeTable', 'common'], function () {
      var $ = layui.$
        , admin = layui.admin
        , view = layui.view
        , form = layui.form
        , treeTable = layui.treeTable
        , common = layui.common;

      // 调用 common.js 模块 getPopupSize 函数，用 ES6 解构赋值获取返回的两个参数
      const { popupWidthHeight, popupOffsetWidthHeight } = common.getPopupSize();

      ///////model
      form.on("input-affix(searchPermis)", function (data) {
        var menuIds = $("#menuIds").val();
        admin.popup({
          title: "权限配置",
          area: popupWidthHeight,
          offset: popupOffsetWidthHeight,
          id: "popup-system-role-form-permis",
          success: function (layero, index) { 
            view(this.id)
              .render("system/role/permis-form", menuIds)
              .done(function () {
                form.render(null, "system-role-permis-form");
                //提交
                form.on("submit(system-role-permis-form-submit)",
                  function (data) {
                    var field = data.field; 
                    form.val("system-role-form", field); 
                    layer.close(index); 
                  }
                );
              });
          },
        });
      }); 
    });
  }

 
  layui.use(['admin', 'form', 'xmSelect'], function () {
    var $ = layui.$
      , admin = layui.admin
      , view = layui.view
      , form = layui.form
      , xmSelect = layui.xmSelect;


  });
</script>