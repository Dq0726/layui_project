<div class="layui-form" lay-filter="zkmes-productmgmt-product-classify-form" style="padding: 10px 30px 0 0">
   
  <!--    传值给父start -->
  <input type="text"  name="classifyId" placeholder="请输入"  autocomplete="off" class="layui-input layui-hide" /> 
  <input type="text"  name="classifyName" placeholder="请输入"  autocomplete="off" class="layui-input layui-hide" /> 
 <!--    传值给父end -->
 
 
  <!--    search start -->
  <div class="layui-form-item">
    <div class="layui-inline">
      <label class="layui-form-label">产品分类编号</label>
      <div class="layui-input-inline"> 
          <input type="text"  id="classifyId" placeholder="请输入"  autocomplete="off" class="layui-input" /> 
      </div>
    </div>
    <div class="layui-inline">
      <label class="layui-form-label">产品分类名称</label>
      <div class="layui-input-inline"> 
          <input type="text"  id="classifyName" placeholder="请输入"  autocomplete="off" class="layui-input" /> 
      </div>
    </div>     
     <div class="layui-inline zkmes-productmgmt-product-classify-form-search">
      <div class="layui-input-inline"> 
          <button class="layui-btn" data-type="reload">搜索</button>
      </div>
    </div> 
  </div>
 
 <!--    search end -->
 
 
  
  <div class="layui-form-item">
    <table id="zkmes-productmgmt-product-classify-form-table" lay-filter="zkmes-productmgmt-product-classify-form-table"></table>
    <script type="text/html" id="zkmes-productmgmt-product-classify-form-toolbar-row">
    </script>
  </div>

 <div class="layui-form-item layui-hide">
    <label class="layui-form-label"></label>
    <div class="layui-input-inline">
      <input type="button" id="zkmes-productmgmt-product-classify-form-submit" lay-submit lay-filter="zkmes-productmgmt-product-classify-form-submit" value="确认" class="layui-btn" />
    </div>
  </div>
</div>

<script>    
  layui.use(["admin", "form"], function () {
    var $ = layui.$,
      admin = layui.admin,
      view = layui.view,
      table = layui.table,
      form = layui.form,
      treeTable = layui.treeTable;

    active = {
 	    reload: function(){ 
 	      var classifyId = $('#classifyId'); 
 	     //执行重载
	      table.reloadData('zkmes-productmgmt-product-classify-form-table', {
	        page: {
	          curr: 1 //重新从第 1 页开始
	        }
	        ,where: { 
	        	  classifyId: classifyId.val() 
	        }
	      }); 
 	    } 
 	  };
    	  
    	  
   	$('.zkmes-productmgmt-product-classify-form-search .layui-btn').on('click', function(){
       var type = $(this).data('type');
       active[type] ? active[type].call(this) : '';
    });
     
    var prefix = "zkmes/productmgmt/classify";

    treeTable.render({
      elem: "#zkmes-productmgmt-product-classify-form-table",
      url: prefix + "/list",  
      page: true,
      height: "full-350",
      tree: {
          customName: {
            id: "classifyId", //子ID
            pid: "parentId", // 父ID
            name: "classifyName",
          },
          data: {
            isSimpleData: true,
          },
          view: {
            expandAllDefault: true,
          },
        },
      cols: [[
    	  { field: "classifyName", title: "产品分类名" },
          { field: "orderNum", title: "排序" },
          {
            field: "mop",
            title: "种类",
            templet: function (res) {
              var text = res.status == 0 ? "物料" : "成本";
              var html = '<span class="layui-badge layui-bg-green">' + text + "</span>";
              return html;
            },
          },
          {
            field: "status",
            title: "状态",
            templet: function (res) {
              var text = res.status == 0 ? "正常" : "停用";
              var html = '<span class="layui-badge layui-bg-blue">' + text + "</span>";
              return html;
            },
          },
          { field: "createTime", title: "创建时间" },
        ],
      ],
      style: "margin-top:0;",
      response: {
        statusName: "code", //数据状态的字段名称，默认：code
        statusCode: 200, //成功的状态码，默认：0
        msgName: "msg", //状态信息的字段名称，默认：msg
        dataName: "data", //数据列表的字段名称，默认：data
      },      
    });
     
  //触发行双击事件
    table.on('rowDouble(zkmes-productmgmt-product-classify-form-table)', function(obj){
    	 // console.log(obj.tr) //得到当前行元素对象
    	 // console.log(obj.data) //得到当前行数据
    	   
    	  var submit  = $("#zkmes-productmgmt-product-classify-form-submit")  
    	  var data = form.val('zkmes-productmgmt-product-classify-form', JSON.parse(JSON.stringify(obj.data)));
    	   
    	  form.render();
 
    	  submit.trigger('click');
    });
      
  });
</script>
